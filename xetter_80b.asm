;
;  XETTER
;     for MZ-80B
;
;Oct. 5, 1984
;     by K.Kuromusha
;
 OFFSET $8460
 START  $12A0
;
;Object ƒ $9700~
;
GAMEN EQU GAMN+41
;
 GOTO START
;
GC    [AF [HL [BC [DE
 !VOP
 A=0 HL=$E000
 (HL)=A
 DE=$E001 BC=$1F40
 LDIR
 !VCL
 ]DE ]BC ]HL ]AF
 RET
;
VC    [AF [HL [BC [DE
 !VOP
 A=0 HL=$D000
 (HL)=A
 DE=$D001 BC=$03E8
 LDIR
 !VCL
 ]DE ]BC ]HL ]AF
 RET
;
VOP   [AF
 A=PORT($E8)
 SET(7,A)
 PORT($E8)=A
 ]AF RET
;
VCL   [AF
 A=PORT($E8)
 RES(7,A)
 PORT($E8)=A
 ]AF RET
;
SHOKI !$0CEE  ;CHR40
 A=PORT($E8)
 RES(7,A)
 RES(6,A)
 PORT($E8)=A
 A=2
 PORT($F4)=A
 A=1 HL=$000B
 (HL)=A
 A=$18 HL+
 (HL)=A
 !$08D3
 HL=$11D0
 A=$12
 (HL)=A
 A=$1F
 A=A.&.(HL)
 (HL)=A
 PORT($E0)=A
 !GC !VC
 HL=0 (HI)=HL
 A=7 !$0E50  ;TEMPO
 A=0 ($1039)=A  ;Don't stop MUSIC
 RET
;
 DEFS 80
;
START SP=START
 !SHOKI
L0    !DEMO
L1    A=(MEN)
 IF A=251 GOTO CLEAR
 !S3
LOOP  !IMOVE
 !SSC
 A=(BOM)
 IF A=1 GOTO BOMY
 A=(CLR)
 IF A=0 GOTO CLR1
 !EMOVE
 A=(BOM)
 IF A=1 GOTO BOMY
 !YMOVE
 HL=(TIME)
 HL-
 (TIME)=HL
 !SSC
 A=(BOM)
 IF A=1 GOTO BOMY
 HL=(TIME)
 IF HL=0 GOTO BOMY
 GOTO LOOP
;
SC    DEFS 2
HI    DEFS 2
BOM   DEFS 1
CLR   DEFS 1
MEN   DEFS 1
MY    DEFS 1
;
DEM0  !(""0D)
DEM1  !("              "0D)
DEM2  !("                                "0D)
DEM3  !("                         "0D)
DEM4  !("                                "0D)
DEM5  !("                     "0D)
;
DE0   !(""0D)
DE1   !("      Copyright (C) by K.Kuromusha      "0D)
DE2   !(""0D)
DE3   !("     Push 1 or 2 key.                   "0D)
DE4   !("                1. GAME START           "0D)
DE5   !("                2. INPUT 'KEY WORD'"0D)
;
WAIT  [BC
 DO B=0
 C=0
W1    C-
 IF C<>0 GOTO W1
 UNTIL DEC(B)=0
 ]BC RET
;
SCU   [HL [DE [BC [AF
 !VOP
 HL=$D028
 DE=$D000
 BC=$03C0
 LDIR
 !VCL
 ]AF ]BC ]DE ]HL
 RET
;
SCD   [HL [DE [BC [AF
 !VOP
 HL=$D3BF
 DE=$D3E7
 BC=$03C0
 LDDR
 !VCL
 ]AF ]BC ]DE ]HL
 RET
;
WAIT0 [BC
 DO B=0
 UNTIL DEC(B)=0
 ]BC RET
;
DEMO  !GC !VC
 HL=0 (SC)=HL
 A=1 (MEN)=A
 A=5 (MY)=A
 DE=DEM0 !$0889
 DE=DEM1 !$0889
 DE=DEM2 !$0889
 DE=DEM3 !$0889
 DE=DEM4 !$0889
 DE=DEM5 !$0889
 DO A=4
 !WAIT
 UNTIL DEC(A)=0
 DO A=9
 !SCD !WAIT0
 UNTIL DEC(A)=0
 DO A=14
 !SCU !WAIT0
 UNTIL DEC(A)=0
 B=4
SCL   DO A=15
 !SCD !WAIT0
 UNTIL DEC(A)=0
 DO A=15
 !SCU !WAIT0
 UNTIL DEC(A)=0
 B-
 IF B<>0 GOTO SCL
 DE=DE0 !$0889
 DE=DE1 !$0889
 DE=DE2 !$0889
 DE=DE3 !$0889
 DE=DE4 !$0889
 DE=DE5 !$0889
KDEMO !VOP
 A="ñ" ($D2B2)=A
 A="2" ($D2B7)=A
 !VCL
 DO BC=$500
 !$0832
 IF A="1" RET
 IF A="2" GOTO KW
 UNTIL DEC(BC)=0
 !VOP
 A="1" ($D2B2)=A
 A="ò" ($D2B7)=A
 !VCL
 DO BC=$500
 !$0832
 IF A="1" RET
 IF A="2" GOTO KW
 UNTIL DEC(BC)=0
 GOTO KDEMO
;
KW5   !("      ")
KW10  !("      ")
KW15  !("      ")
KW20  !("      ")
KW25  !("      ")
KW30  !("      ")
KW35  !("      ")
KW40  !("      ")
KW45  !("      ")
KW50  !("      ")
KW55  !("      ")
KW60  !("      ")
KW65  !("      ")
KW70  !("      ")
KW75  !("      ")
KW80  !("      ")
KW85  !("      ")
KW90  !("      ")
KW95  !("      ")
KW100 !("      ")
KW105 !("      ")
KW110 !("      ")
KW115 !("      ")
KW120 !("      ")
KW125 !("      ")
KW130 !("      ")
KW135 !("      ")
KW140 !("      ")
KW145 !("      ")
KW150 !("      ")
KW155 !("      ")
KW160 !("      ")
KW165 !("      ")
KW170 !("      ")
KW175 !("      ")
KW180 !("      ")
KW185 !("      ")
KW190 !("      ")
KW195 !("      ")
KW200 !("      ")
KW205 !("      ")
KW210 !("      ")
KW215 !("      ")
KW220 !("      ")
KW225 !("      ")
KW230 !("      ")
KW235 !("      ")
KW240 !("      ")
KW245 !("      ")
KW250 !("      ")
;
KEY   DEFS 6
;
KED   !("Please INPUT 'KEY WORD'   ¢£"0D)
;
KW    !VC
 DE=KED !$0889
 !VOP
 DO E=6
KEYWK !$0832
 IF A=0 GOTO KEYWK
 D=A
 !$0F14
 A=6 A=A-E
 BC=0 C=A
 HL=$D045 HL=HL+BC
 A=D (HL)=A
 UNTIL DEC(E)=0
 HL=$D045
 DE=KEY
 BC=6
 LDIR
 !VCL
 HL=KW5-6 D=1
 DO E=50
 A=(MEN) A=A+5
 (MEN)=A
 HL=HL+6
 !CHECK
 IF D=0 RET
 UNTIL DEC(E)=0
 GOTO DEMO
;
CHECK [HL C=0
 A=(HL) B=A
 A=(KEY)
 IF A<>B THEN C=1
 HL+ A=(HL) B=A
 A=(KEY+1)
 IF A<>B THEN C=1
 HL+ A=(HL) B=A
 A=(KEY+2)
 IF A<>B THEN C=1
 HL+ A=(HL) B=A
 A=(KEY+3)
 IF A<>B THEN C=1
 HL+ A=(HL) B=A
 A=(KEY+4)
 IF A<>B THEN C=1
 HL+ A=(HL) B=A
 A=(KEY+5)
 IF A<>B THEN C=1
 IF C=0 THEN D=0
 ]HL RET
;
PUT   [HL [DE [BC [AF
 !VOP
 A=(GX) C=A
 A=(GY) B=A
 HL=GAMEN-40
 DE=BC
 D=0
 HL=HL+DE
 DO B=B+1
 HL=HL+40
 UNTIL DEC(B)=0
 A=(GZ)
 [AF
 IF A>=6 THEN A=6
 (HL)=A HL+
 (HL)=A HL=HL+39
 (HL)=A HL+
 (HL)=A
 A=(GX) C=A
 A=(GY) B=A
 ]AF
 B+ C+
 HL=$E501
 DO HL=HL-1
 HL=HL+1
 UNTIL DEC(C)=0
 DO HL=HL-320
 HL=HL+320
 UNTIL DEC(B)=0
 BC=GC0
 IF A=1 THEN BC=GC1
 IF A=2 THEN BC=GC2
 IF A=3 THEN BC=GC3
 IF A=4 THEN BC=GC4
 IF A=5 THEN BC=GC5
 IF A=6 THEN BC=GC6
 IF A=7 THEN BC=GC7
 IF A=8 THEN BC=GC8
 IF A=9 THEN BC=GC9
 [HL
 HL=BC HL=HL+16
 BC=HL ]HL
 DO D=16
 A=(BC)
 (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 HL=HL-639
 [HL
 HL=BC HL=HL-32
 BC=HL ]HL
 DO D=16
 A=(BC)
 (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 !VCL
 ]AF ]BC ]DE ]HL
 RET
;
GX    DEFS 1
GY    DEFS 1
GZ    DEFS 1
;
GAMN  !("")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("")
;
GC0   DEFS 32
GC1   !(000042657A427D6255637E3E06467E3C000042A65E42BE46AAC67E7C60627E3C)
GC2   !(000018214729152D217E7C7F06467E3C00001884E294A8B4847E3EFE60627E3C)
GC3   !(FF80BFA0AFA8ABAAAAABA8AFA0BF80FFFF01FD05F515D55555D515F505FD01FF)
GC4   !(1824429999422418182442999942241818244299994224181824429999422418)
GC5   !(FEFEFE00F7F7F700FEFEFE00F7F7F700FEFEFE00F7F7F700FEFEFE00F7F7F700)
GC6   !(0000070F1F3F7F7F7F7F7F7F3F0F073E0000E0F0F8FCFEFEFEFEFEFEFCF0E07C)
GC7   !(0000070F1B3B7F7877777777380F073E0000E0F0D8DCFE1EEEEEEEEE1CF0E07C)
GC8   !(00001F3F7E7EFFFFFFFF7F7F3F1F0F1F0000C6E6F6EEDEBEB6A6D6F6E0C098FC)
GC9   !(000063676F777B7D6D656B6F6703193F0000F8FC7E7EFFFFFFFFFEFEFCF8F0F8)
GC10  !(3F7FFBFBFF7E0FFCFCFEDFDFFF7EF03F)
GC11  !(82FE847F61BFFE7E417F11FE86FD7F7E)
GC12  !(0173477D11BDFE7E80CEE2BE88BD7F7E)
;
SPUT  [HL [DE [BC [AF
 !VOP
 A=(GX) C=A
 A=(GY) B=A
 HL=GAMEN-40
 DE=BC
 D=0
 HL=HL+DE
 DO B=B+1
 HL=HL+40
 UNTIL DEC(B)=0
 A=(GZ)
 (HL)=A HL+
 (HL)=A
 A=(GX) C=A
 A=(GY) B=A
 A=(GZ)
 B+ C+
 HL=$E501
 DO HL=HL-1
 HL=HL+1
 UNTIL DEC(C)=0
 DO HL=HL-320
 HL=HL+320
 UNTIL DEC(B)=0
 BC=GC0
 IF A=10 THEN BC=GC10
 IF A=11 THEN BC=GC11
 IF A=12 THEN BC=GC12
 [HL
 HL=BC HL=HL+8
 BC=HL ]HL
 DO D=8
 A=(BC)
 (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 HL=HL-319
 [HL
 HL=BC HL=HL-16
 BC=HL ]HL
 DO D=8
 A=(BC)
 (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 !VCL
 ]AF ]BC ]DE ]HL
 RET
;
WALLS (HL)=$FE HL=HL+40
 (HL)=$FE HL=HL+40
 (HL)=$FE HL=HL+40
 (HL)=$00 HL=HL+40
 (HL)=$F7 HL=HL+40
 (HL)=$F7 HL=HL+40
 (HL)=$F7 HL=HL+40
 (HL)=$00
 RET
;
WALL  [BC [DE [HL [AF
 IF A<>0 THEN !GGC GOTO WALL0
 !GC
WALL0 !VOP
 HL=$E000
 DO B=40
 !WALLS
 HL=HL-279
 UNTIL DEC(B)=0
 HL=$E3C0
 DO B=40
 !WALLS
 HL=HL-279
 UNTIL DEC(B)=0
 HL=$FE00
 DO B=40
 !WALLS
 HL=HL-279
 UNTIL DEC(B)=0
 HL=$E140
 DO B=23
 !WALLS
 HL=HL+40
 UNTIL DEC(B)=0
 HL=$E167
 DO B=23
 !WALLS
 HL=HL+40
 UNTIL DEC(B)=0
 HL=$E151
 DO B=2
 !WALLS
 HL=HL+40
 UNTIL DEC(B)=0
 HL=$E15B
 DO B=2
 !WALLS
 HL=HL+40
 UNTIL DEC(B)=0
 !VCL
 ]AF ]HL ]DE ]BC
 RET
;
MYX   DEFS 1
MYY   DEFS 1
;
T11   DEFS 3
T12   DEFS 3
T13   DEFS 3
T14   DEFS 3
T21   DEFS 3
T22   DEFS 3
T23   DEFS 3
T24   DEFS 3
;
IWA1  DEFS 3
IWA2  DEFS 3
IWA3  DEFS 3
IWA4  DEFS 3
IWA5  DEFS 3
IWA6  DEFS 3
IWA7  DEFS 3
IWA8  DEFS 3
IWA9  DEFS 3
IWA10 DEFS 3
IWA11 DEFS 3
IWA12 DEFS 3
IWA13 DEFS 3
IWA14 DEFS 3
IWA15 DEFS 3
;
TIME  DEFS 2
;
S3    !VC
 A=0
 (BOM)=A
 (CLR)=A
 (MYX)=A
 (MYY)=A
 (BGMD)=A
 HL=1500
 (TIME)=HL
 HL=T11
 (HL)=0
 DE=T11+1
 BC=68
 LDIR
 HL=END-190
 A=(MEN)
 DO
 HL=HL+190
 UNTIL DEC(A)=0
 !WALL
 E=0
S3S1  D=0
S3S2  A=(HL)
 [HL
 !TOROK
 ]HL
 (GZ)=A
 A=D (GX)=A
 A=E (GY)=A
 !PUT
 HL+
 D++
 A=38
 IF A<>D GOTO S3S2
 E++
 A=20
 IF A<>E GOTO S3S1
 DE=S3D1 !$0889
 DE=S3D2 !$0889
 A=(CLR) IF A=0 THEN HL=L0 (SP)<>HL RET
 HL=$E15C
 A=(MY)
S3S3  IF DEC(A)=0 GOTO S3S4
 [AF !VOP
 BC=GC7 [HL
 HL=BC HL=HL+16
 BC=HL ]HL
 DO D=16
 A=(BC) (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 HL=HL-639
 [HL
 HL=BC HL=HL-32
 BC=HL ]HL
 DO D=16
 A=(BC) (HL)=A
 BC+ HL=HL+40
 UNTIL DEC(D)=0
 HL=HL-639
 !VCL ]AF
 GOTO S3S3
S3S4  !SSC
 DO A=3
 !WAIT
 UNTIL DEC(A)=0
 RET
;
TOROK IF A=" " THEN A=0 RET
 IF A="6" THEN A=9 RET
 IF A="5" THEN A=5 RET
 IF A="4" THEN A=(CLR) A=A+4 (CLR)=A A=4 RET
 IF A="3" GOTO TR3
 IF A="2" GOTO TR2
 IF A="1" GOTO TR1
 RET
;
TR1   HL=T11+2
TR1S  A=(HL)
 IF A<>0 THEN HL=HL+3 GOTO TR1S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=1 RET
;
TR2   HL=T21+2
TR2S  A=(HL)
 IF A<>0 THEN HL=HL+3 GOTO TR2S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=2 RET
;
TR3   HL=IWA1+2
TR3S  A=(HL)
 IF A<>0 THEN HL=HL+3 GOTO TR3S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=3 RET
;
S3D1  !("HI-SCORE         SCENE"0D)
S3D2  !("SCORE         TIME"0D)
;
SSCD1 !("      0"0D)
SSCD2 DEFS 4
;
SSC   [BC [DE [HL [AF
 HL=(SC)
 BC=HL
 HL=(HI)
 A=H
 IF A=B GOTO HIS1
 IF A<B GOTO HIS2
 GOTO HIS3
HIS1  A=L
 IF A>=C GOTO HIS3
HIS2  HL=BC
 (HI)=HL
HIS3  !SSCS
 HL=$11D1
 (HL)=10
 HL+ (HL)=2
 DE=SSCD1 !SCS
 !$0889
 HL=(HI)
 BC=HL
 !SSCS
 HL=$11D1
 (HL)=10
 HL+ (HL)=1
 DE=SSCD1 !SCS
 !$0889
 HL=(TIME)
 BC=HL
 !SSCS
 HL=$11D1
 (HL)=23
 HL+ (HL)=2
 DE=SSCD1+2 !SCS0
 HL=SSCD1+6
 (HL)=$0D
 !$0889
 (HL)="0"
 HL=(MEN)
 B=0 C=L
 !SSCS
 HL=$11D1
 (HL)=24
 HL+ (HL)=1
 DE=SSCD1+3 !SCS1
 HL=SSCD1+6
 (HL)=$0D
 !$0889
 (HL)="0"
 ]AF ]HL ]DE ]BC
 RET
;
SSCS  !SSCL
 A=$F0
 A=A.&.B
 RLC(A) RLC(A) RLC(A) RLC(A)
 D=A
 A=4 (SSCD2)=A
 A=0 (SSCD2+1)=A
 A=9 (SSCD2+2)=A
 A=6 (SSCD2+3)=A
SSCS1 IF D=0 GOTO SSCS2
 !PLAS D-
 GOTO SSCS1
SSCS2 A=$0F
 A=A.&.B
 D=A
 A=0 (SSCD2)=A
 A=2 (SSCD2+1)=A
 A=5 (SSCD2+2)=A
 A=6 (SSCD2+3)=A
SSCS3 IF D=0 GOTO SSCS4
 !PLAS D-
 GOTO SSCS3
SSCS4 A=$F0
 A=A.&.C
 RLC(A) RLC(A) RLC(A) RLC(A)
 D=A
 A=0 (SSCD2)=A
 (SSCD2+1)=A
 A=1 (SSCD2+2)=A
 A=6 (SSCD2+3)=A
SSCS5 IF D=0 GOTO SSCS6
 !PLAS D-
 GOTO SSCS5
SSCS6 A=$0F
 A=A.&.C
 D=A
 A=0 (SSCD2)=A
 (SSCD2+1)=A
 (SSCD2+2)=A
 A=1 (SSCD2+3)=A
SSCS7 IF D=0 GOTO SSCS8
 !PLAS D-
 GOTO SSCS7
SSCS8 !SSCSS
 RET
;
SSCL  [HL [AF
 HL=SSCD1
 A=0 (HL)=A
 HL+ (HL)=A
 HL+ (HL)=A
 HL+ (HL)=A
 HL+ (HL)=A
 HL+ (HL)=A
 ]AF ]HL
 RET
;
PLAS  [BC [DE [HL [AF
 A=(SSCD1+5) B=A
 A=(SSCD2+3)
 A=A+B C=0
 IF A>=10 THEN A=A-10 C=1
 (SSCD1+5)=A
 A=(SSCD1+4) B=A
 A=(SSCD2+2)
 A=A+B A=A+C C=0
 IF A>=10 THEN A=A-10 C=1
 (SSCD1+4)=A
 A=(SSCD1+3) B=A
 A=(SSCD2+1)
 A=A+B A=A+C C=0
 IF A>=10 THEN A=A-10 C=1
 (SSCD1+3)=A
 A=(SSCD1+2) B=A
 A=(SSCD2)
 A=A+B A=A+C C=0
 IF A>=10 THEN A=A-10 C=1
 (SSCD1+2)=A
 A=(SSCD1+1)
 A=A+C C=0
 IF A>=10 THEN A=A-10 C=1
 (SSCD1+1)=A
 A=(SSCD1)
 A=A+C
 (SSCD1)=A
 ]AF ]HL ]DE ]BC
 RET
;
SSCSS [AF [HL [BC
 HL=SSCD1
 DO B=6
 A=(HL) A=A+$30
 (HL)=A
 HL+
 UNTIL DEC(B)=0
 ]BC ]HL ]AF
 RET
;
SCS   [AF [HL [BC
 HL=SSCD1
 DO B=6
 A=(HL)
 IF A<>"0" GOTO SCSS
 A=" "
 (HL)=A HL+
 UNTIL DEC(B)=0
SCSS  ]BC ]HL ]AF
 RET
;
SCS0  [AF [HL [BC
 HL=SSCD1+2
 DO B=3
 A=(HL)
 IF A<>"0" GOTO SCS0S
 A=" "
 (HL)=A HL+
 UNTIL DEC(B)=0
SCS0S ]BC ]HL ]AF
 RET
;
SCS1  [AF [HL [BC
 HL=SSCD1+3
 DO B=2
 A=(HL)
 IF A<>"0" GOTO SCS1S
 A=" "
 (HL)=A HL+
 UNTIL DEC(B)=0
SCS1S ]BC ]HL ]AF
 RET
;
BOMY  DE=MS1
 !$0F3F
 A=(MY) A-
 (MY)=A
 IF A<>0 GOTO L1
 DE=MS2
 !$0F3F
 !WALL
 DE=BOMYD
 !$0889
 DO B=8
 !WAIT
 UNTIL DEC(B)=0
 GOTO L0
;
MS1   !("-C0-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C"0D)
MS2   !("R9+B2+A+G+F+E+D+CBAGEDC-B-A-G-F-E-D-C-D-E-F-G-A-BR-C9"0D)
BOMYD !("               GAME OVER"0D)
;
CLR1  HL=(SC)
 DE=100
 HL=HL+DE
 (SC)=HL
 !SSC !WAIT
 DE=MS3
 !$0F3F
 A=(MEN) A+
 (MEN)=A B=A
 DO A=251
 IF A=B GOTO KEYP
 A=A-5
 UNTIL A=1
 !WAIT
 GOTO L1
;
MS3   !("B2AGBDGBAFBBAGBDGBAFBBAGBDGBAFB9"0D)
;
CLR1D !("                KEY WORD"0D)
CLR2D !("            PUSH [SPACE] KEY"0D)
;
KEYP  [AF A=1 !WALL ]AF
 DE=CLR1D
 !$0889
 A-
 IF A=5 THEN HL=KW5
 IF A=10 THEN HL=KW10
 IF A=15 THEN HL=KW15
 IF A=20 THEN HL=KW20
 IF A=25 THEN HL=KW25
 IF A=30 THEN HL=KW30
 IF A=35 THEN HL=KW35
 IF A=40 THEN HL=KW40
 IF A=45 THEN HL=KW45
 IF A=50 THEN HL=KW50
 IF A=55 THEN HL=KW55
 IF A=60 THEN HL=KW60
 IF A=65 THEN HL=KW65
 IF A=70 THEN HL=KW70
 IF A=75 THEN HL=KW75
 IF A=80 THEN HL=KW80
 IF A=85 THEN HL=KW85
 IF A=90 THEN HL=KW90
 IF A=95 THEN HL=KW95
 IF A=100 THEN HL=KW100
 IF A=105 THEN HL=KW105
 IF A=110 THEN HL=KW110
 IF A=115 THEN HL=KW115
 IF A=120 THEN HL=KW120
 IF A=125 THEN HL=KW125
 IF A=130 THEN HL=KW130
 IF A=135 THEN HL=KW135
 IF A=140 THEN HL=KW140
 IF A=145 THEN HL=KW145
 IF A=150 THEN HL=KW150
 IF A=155 THEN HL=KW155
 IF A=160 THEN HL=KW160
 IF A=165 THEN HL=KW165
 IF A=170 THEN HL=KW170
 IF A=175 THEN HL=KW175
 IF A=180 THEN HL=KW180
 IF A=185 THEN HL=KW185
 IF A=190 THEN HL=KW190
 IF A=195 THEN HL=KW195
 IF A=200 THEN HL=KW200
 IF A=205 THEN HL=KW205
 IF A=210 THEN HL=KW210
 IF A=215 THEN HL=KW215
 IF A=220 THEN HL=KW220
 IF A=225 THEN HL=KW225
 IF A=230 THEN HL=KW230
 IF A=235 THEN HL=KW235
 IF A=240 THEN HL=KW240
 IF A=245 THEN HL=KW245
 IF A=250 THEN HL=KW250
 !VOP
 BC=$D1F1
 DO D=6
 A=(HL)
 (BC)=A
 HL+ BC+
 UNTIL DEC(D)=0
 !VCL
 DE=CLR2D
 !$0889
CLKEY !$0832
 IF A<>" " GOTO CLKEY
 GOTO L1
;
CLEAR !GC
 DE=CRD1 !$0889 !$0A2E
 DE=CRD2 !$0889 !$0A2E
 DE=CRD3 !$0889 !$0A2E
 DE=CRD4 !$0889 !$0A2E
 DE=CRD5 !$0889 !$0A2E
 DO B=3
 DE=MS3
 !$0F3F
 UNTIL DEC(B)=0
CRK   !$0832
 IF A<>" " GOTO CRK
 GOTO L0
;
CRD1  !("µÒÃÞÄ³ !!"0D)
CRD2  !(" ±ÅÀ Ê, 250ÒÝ ¾ÞÝÌÞ ¦ ¸ØÔ- ¼Ï¼À¡"0D)
CRD3  !(" ºÞ¸Û-»Ï ÃÞ¼À¡"0D)
CRD4  !(" Let's try again 'XETTER'"0D)
CRD5  !(" PUSH [SPACE] KEY"0D)
;
BGMD  DEFS 1
;
BGM   !("G1*G1*F1*E1*D1*G1*G1*F1*E1*D1*")
 !("G1*G1*F1*E1*D1*G1*G1*A1*B1*")
 !("G1*G1*F1*E1*D1*G1*G1*F1*E1*D1*")
 !("G1*G1*F1*E1*D1*G1*G1*A1*B1*")
 !("B1*G1*B1*G1*B1*G1*G1*A1*B1*A1*F1*A1*F1*A1*F1*")
 !("E1*D1*C1*")
 !("B1*G1*B1*G1*B1*G1*G1*A1*B1*A1*F1*A1*F1*A1*F1*")
 !("E1*D1*C1*")
;
IMOVE HL=BGM-3
 A=(BGMD)
 A+
 IF A=75 THEN A=1
 (BGMD)=A
 DO
 HL=HL+3 DE=HL
 UNTIL DEC(A)=0
 !$0F3F
 A=0 !$0901     ;Key data clear
 !$0832
 IF A="4" GOTO IM4
 IF A="6" GOTO IM6
 IF A="2" GOTO IM2
 IF A="8" GOTO IM8
 RET
;
IM4   HL=(MYX)
 !XHL
 HL- A=(HL)
 B=A
 HL=HL+40
 A=(HL)
 IF A<>B GOTO IM4S
 IF A=5 GOTO IM4P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL=HL+2 (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM4E
IM4PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYX)
 A- (MYX)=A
IM4P  HL=(MYX)
 (GX)=HL
 A=8 (GZ)=A
 !PUT
 RET
;
IM4E  HL=(MYX)
 !XHL
 HL-- HL-
 A=(HL) B=A
 HL=HL+40
 A=(HL)
 IF A<>B GOTO IM4P
 IF A<>0 GOTO IM4P
 A=4 !ISECH
 IF HL=0 GOTO IM4P
 A=(HL) A-
 (HL)=A
 HL=(MYX) L--
 (GX)=HL
 A=0 (GZ)=0
 !PUT
 L-
 (GX)=HL
 A=3 (GZ)=A
 !PUT
 GOTO IM4PS
;
ISECH HL=(MYX)
 IF A=4 THEN L--
 IF A=6 THEN L++
 BC=IWA1 DE=HL A=0
ISH0  [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=0 GOTO ISH1
 HL=HL-DE
 IF H<>0 GOTO ISH1
 IF L<>0 GOTO ISH1
 ]AF BC-- BC-
 HL=BC
 RET
;
ISH1  ]AF A+
 IF A=15 THEN HL=0 RET
 GOTO ISH0
;
IM6   HL=(MYX)
 !XHL
 HL++ A=(HL)
 B=A
 HL=HL+40
 A=(HL)
 IF A<>B GOTO IM6S
 IF A=5 GOTO IM6P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL=HL+2 (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM6E
IM6PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYX)
 A+ (MYX)=A
IM6P  HL=(MYX)
 (GX)=HL
 A=9 (GZ)=A
 !PUT
 RET
;
IM6E  HL=(MYX)
 !XHL
 HL++ HL++
 A=(HL) B=A
 HL=HL+40
 A=(HL)
 IF A<>B GOTO IM6P
 IF A<>0 GOTO IM6P
 A=6 !ISECH
 IF HL=0 GOTO IM6P
 A=(HL) A+
 (HL)=A
 HL=(MYX) L++
 (GX)=HL
 A=0 (GZ)=0
 !PUT
 L+
 (GX)=HL
 A=3 (GZ)=A
 !PUT
 GOTO IM6PS
;
IM2   HL=(MYX)
 !XHL
 HL=HL+80 A=(HL)
 B=A
 HL+
 A=(HL)
 IF A<>B GOTO IM2S
 IF A=5 GOTO IM2P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL=HL+2 (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM2P
IM2PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYY)
 A+ (MYY)=A
IM2P  HL=(MYX)
 (GX)=HL
 A=7 (GZ)=A
 !PUT
 RET
;
IM8   HL=(MYX)
 !XHL
 HL=HL-40 A=(HL)
 B=A
 HL+
 A=(HL)
 IF A<>B GOTO IM8S
 IF A=5 GOTO IM8P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL=HL+2 (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM8P
IM8PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYY)
 A- (MYY)=A
IM8P  HL=(MYX)
 (GX)=HL
 A=6 (GZ)=A
 !PUT
 RET
;
XHL   [DE [BC [AF
 DE=HL
 HL=GAMEN-40
 BC=DE D=0
 HL=HL+DE
 DO B+
 HL=HL+40
 UNTIL DEC(B)=0
 ]AF ]BC ]DE
 RET
;
IM4S  IF A=5 GOTO IM4P
 B-- B-- B- IF B=0 GOTO IM4P
 IF A=3 GOTO IM4P
 B++ IF B=0 GOTO IM4P
 B+ IF A=1 THEN IF B=0 GOTO IM4SA
 B+ IF A=2 THEN IF B=0 GOTO IM4SA
 B+ IF A=1 THEN IF B=0 GOTO IM4SA
 B- IF B=0 THEN IF A=0 GOTO IM4SA
 B+ IF A=2 THEN IF B=0 GOTO IM4SA
 B-- IF B=0 THEN IF A=0 GOTO IM4SA
 B-- IF A=1 THEN IF B=0 GOTO IM4SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM4SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM4SB
 B++ IF B=0 THEN IF A=4 GOTO IM4SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM4PS
IM4SA (BOM)=1 GOTO IM4PS
IM4SB (BOM)=1 HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM4PS
;
IM6S  IF A=5 GOTO IM6P
 B-- B-- B- IF B=0 GOTO IM6P
 IF A=3 GOTO IM6P
 B++ IF B=0 GOTO IM6P
 B+ IF A=1 THEN IF B=0 GOTO IM6SA
 B+ IF A=2 THEN IF B=0 GOTO IM6SA
 B+ IF A=1 THEN IF B=0 GOTO IM6SA
 B- IF B=0 THEN IF A=0 GOTO IM6SA
 B+ IF A=2 THEN IF B=0 GOTO IM6SA
 B-- IF B=0 THEN IF A=0 GOTO IM6SA
 B-- IF A=1 THEN IF B=0 GOTO IM6SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM6SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM6SB
 B++ IF B=0 THEN IF A=4 GOTO IM6SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM6PS
IM6SA (BOM)=1 GOTO IM6PS
IM6SB (BOM)=1 HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM6PS
;
IM2S  IF A=5 GOTO IM2P
 B-- B-- B- IF B=0 GOTO IM2P
 IF A=3 GOTO IM2P
 B++ IF B=0 GOTO IM2P
 B+ IF A=1 THEN IF B=0 GOTO IM2SA
 B+ IF A=2 THEN IF B=0 GOTO IM2SA
 B+ IF A=1 THEN IF B=0 GOTO IM2SA
 B- IF B=0 THEN IF A=0 GOTO IM2SA
 B+ IF A=2 THEN IF B=0 GOTO IM2SA
 B-- IF B=0 THEN IF A=0 GOTO IM2SA
 B-- IF A=1 THEN IF B=0 GOTO IM2SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM2SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM2SB
 B++ IF B=0 THEN IF A=4 GOTO IM2SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM2PS
IM2SA (BOM)=1 GOTO IM2PS
IM2SB (BOM)=1 HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM2PS
;
IM8S  IF A=5 GOTO IM8P
 B-- B-- B- IF B=0 GOTO IM8P
 IF A=3 GOTO IM8P
 B++ IF B=0 GOTO IM8P
 B+ IF A=1 THEN IF B=0 GOTO IM8SA
 B+ IF A=2 THEN IF B=0 GOTO IM8SA
 B+ IF A=1 THEN IF B=0 GOTO IM8SA
 B- IF B=0 THEN IF A=0 GOTO IM8SA
 B+ IF A=2 THEN IF B=0 GOTO IM8SA
 B-- IF B=0 THEN IF A=0 GOTO IM8SA
 B-- IF A=1 THEN IF B=0 GOTO IM8SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM8SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM8SB
 B++ IF B=0 THEN IF A=4 GOTO IM8SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM8PS
IM8SA (BOM)=1 GOTO IM8PS
IM8SB (BOM)=1 HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM8PS
;
EMOVE HL=IWA1
 DO B=15
 !EMS
 A=(BOM)
 IF A=1 RET
 HL=HL+3
 UNTIL DEC(B)=0
 RET
;
EMS   [HL [BC
 (EMSMC)=0
 DE=HL
 HL++ A=(HL)
 IF A=0 THEN ]BC ]HL RET
 HL--
 HL=(HL)
 !XHL
 HL=HL+80
 A=(HL)
 IF A=5 THEN ]BC ]HL RET
 IF A=4 THEN ]BC ]HL RET
 IF A=3 THEN ]BC ]HL RET
 B=A HL+
 A=(HL)
 IF A=5 THEN ]BC ]HL RET
 IF A=4 THEN ]BC ]HL RET
 IF A=3 THEN ]BC ]HL RET
 IF A=0 THEN IF B=0 GOTO EMS1
 !EMS0
EMS1  HL=DE
 HL=(HL)
 (GX)=HL
 (GZ)=0
 !PUT
 HL=DE HL+
 A=(HL) A+
 (HL)=A HL-
 HL=(HL)
 (GX)=HL
 (GZ)=3
 !PUT
EMS2  A=(EMSMC)
 IF A<>0 THEN A- (EMSMC)=A DE=MS !$0F3F GOTO EMS2
 ]BC ]HL
 RET
;
EMS0  IF A<>B GOTO EMS0S
 IF A=6 GOTO IDED
 HL=DE HL=(HL)
 !ESECH
 IF HL=0 GOTO EMS0S
 (EMSMC)=1
 HL++ A=2
 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL- HL=(HL)
 (GX)=HL
 A=B A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
 RET
;
MS    !("+C1+E+G"0D)
;
IDED  (BOM)=1
 A=(MYY)
 A+ (MYY)=A
 HL=(MYX)
 (GX)=HL
 (GZ)=10
 !SPUT
 RET
;
ESECH [DE [BC
 H++ DE=HL
 BC=T11 A=0
ESE   [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=2 GOTO ESES
 IF A=0 GOTO ESES
 HL=HL-DE
 IF H<>0 GOTO ESES
 IF L<>0 GOTO ESES
 ]AF BC-- BC-
 HL=BC
 ]BC ]DE
 RET
;
ESES  ]AF A+
 IF A=8 THEN ]BC ]DE HL=0 RET
 GOTO ESE
;
EMSMC DEFS 1
;
EMS0S HL=DE
 HL=(HL) !XHL
 HL=HL+79
 EXX
 HL=0
 EXX
 A=(HL)
 IF A=6 GOTO EMI
 [AF !SECH
 IF HL=0 THEN ]AF GOTO EMS1S
 (EMSMC)=1
 [HL
 HL=(HL)
 (GX)=HL
 (GZ)=0
 !PUT ]HL
 ]AF HL++ B=A
 A=2 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL-
 HL=(HL)
 (GX)=HL
 A=B
 A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
EMS1S HL=DE
 HL=(HL) !XHL
 HL=HL+81
 EXX
 HL=1
 EXX
 A=(HL)
 IF A=6 GOTO EMI
 [AF !SECH
 IF HL=0 THEN ]AF RET
 [HL HL=EMSMC (HL)+ ]HL
 [HL HL=(HL)
 (GX)=HL
 (GZ)=0
 !PUT ]HL
 ]AF HL++ B=A
 A=2 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL-
 HL=(HL)
 (GX)=HL
 A=B
 A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
 RET
;
SECH  [DE
 HL=DE HL=(HL) H++
 L+ DE=HL BC=T11
 EXX [HL EXX ]HL
 IF HL=0 THEN E--
 A=0
SECH1 [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=2 GOTO SECH2
 IF A=0 GOTO SECH2
 HL=HL-DE
 IF H<>0 GOTO SECH2
 IF L<>0 GOTO SECH2
 ]AF BC-- BC-
 HL=BC
 ]DE
 RET
;
SECH2 ]AF A+
 IF A=8 THEN ]DE HL=0 RET
 GOTO SECH1
;
EMI   (BOM)=1
 HL=(MYX)
 (GX)=HL
 (GZ)=0
 !PUT
 A=(MYY)
 A+ (MYY)=A
 HL=(MYX)
 (GX)=HL
 (GZ)=10
 !SPUT
 EXX
 [HL
 EXX
 ]HL
 IF HL=0 GOTO EMS1S
 RET
;
YMOVE HL=T11
 DO B=4 A=1
 !T1E HL=HL+3
 UNTIL DEC(B)=0
 DO B=4 A=2
 !T1E HL=HL+3
 UNTIL DEC(B)=0
 RET
;
ARD   DEFS 8
;
AR    BC=ARD
 HL=(HL) !XHL
 HL=HL-40
 A=(HL) (BC)=A
 BC+ HL+
 A=(HL) (BC)=A
 BC+ HL=HL+38
 A=(HL) (BC)=A
 BC+ HL=HL+40
 A=(HL) (BC)=A
 BC+ HL=HL-37
 A=(HL) (BC)=A
 BC+ HL=HL+40
 A=(HL) (BC)=A
 BC+ HL=HL+38
 A=(HL) (BC)=A
 BC+ HL+
 A=(HL) (BC)=A
 RET
;
ARSD  DEFS 4
;
ARS   (ARSD)=0 (ARSD+1)=0
 (ARSD+2)=0 (ARSD+3)=0
 BC=ARD
 HL=ARSD
 DO A=4
 [AF
 A=(BC)
 IF A<>0 THEN IF A<>6 GOTO ARSE1
 BC+
 A=(BC) BC-
 IF A<>0 THEN IF A<>6 GOTO ARSE1
 (HL)=1
ARSE1 BC++ HL+
 ]AF
 UNTIL DEC(A)=0
 RET
;
T1E1  HL=DE
 HL=(HL)
 A=(ARSD) IF A=1 THEN H- GOTO T1E1U
 A=(ARSD+1) IF A=1 THEN L- GOTO T1E1L
 A=(ARSD+3) IF A=1 THEN H+ GOTO T1E1D
 A=(ARSD+2) IF A=1 THEN L+ GOTO T1E1R
;
T1E1D BC=HL
 !XHL HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL (GZ)=0 !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1R BC=HL
 !XHL HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL (GZ)=0 !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1U BC=HL
 !XHL
 A=(HL) IF A=6 THEN (BOM)=1
 HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL (GZ)=0 !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1L BC=HL
 !XHL
 A=(HL) IF A=6 THEN (BOM)=1
 HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL (GZ)=0 !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
TEC   HL++ (HL)=0
 HL-- HL=(HL)
 (GX)=HL
 (GZ)=0
 !SPUT
 ]HL ]AF ]BC
 RET
;
T1E   [BC [AF [HL
 DE=HL HL++
 A=(HL) HL--
 IF A=0 THEN ]HL ]AF ]BC RET
 IF A=2 GOTO TEC
 !AR !ARS
 HL=ARSD C=0
 DO B=4
 A=(HL)
 A=A+C C=A
 HL+
 UNTIL DEC(B)=0
 IF C=0 THEN ]HL ]AF ]BC RET
 C- IF C=0 GOTO T1E1
 HL=DE HL=(HL)
 (HLS)=HL
 ]HL ]AF [AF [HL
 HL=(HLS)
 IF A=1 GOTO T2E
 A=(DE) B=A
 A=(MYX)
 IF A<>B GOTO T1ES
 A=(+DE-)
 B=A A=(MYY)
 IF A>=B GOTO T1E0
 A=(ARSD)
 IF A=1 THEN H- GOTO T1E1U
 GOTO T1ES
T1E0  A=(ARSD+3)
 IF A=1 THEN H+ GOTO T1E1D
T1ES  A=(+DE-) B=A
 A=(MYY)
 IF A<>B GOTO RMOVE
 A=(DE)
 B=A A=(MYX)
 IF A>=B GOTO T1E2
 A=(ARSD+1)
 IF A=1 THEN L- GOTO T1E1L
 GOTO RMOVE
T1E2  A=(ARSD+2)
 IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOVE
;
HLS   DEFS 2
;
RND    [DE [HL
 HL<>DE DE=(HL) DE<>HL
 DE=HL HL=(RNDD)
 HL=HL+DE
 A=H A=A+L
 L=A A=A+H
 L=A DE=$36
 HL=HL+DE (RNDD)=HL
 A=L ]HL ]DE
 RET
;
RNDD  !(1234)
;
RMOVE B=4
RMOV1 HL=DE HL=(HL) !RND
 IF DEC(B)=0 GOTO T1E1
 IF A>=0 THEN IF A<$40 GOTO RM0
 IF A>=$40 THEN IF A<$80 GOTO RM1
 IF A>=$80 THEN IF A<$C0 GOTO RM2
 GOTO RM3
;
RM0   A=(ARSD) IF A=1 THEN H- GOTO T1E1U
 GOTO RMOV1
;
RM1   A=(ARSD+1) IF A=1 THEN L- GOTO T1E1L
 GOTO RMOV1
;
RM2   A=(ARSD+2) IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOV1
;
RM3   A=(ARSD+3) IF A=1 THEN H+ GOTO T1E1D
 GOTO RMOV1
;
T2E   A=(DE)
 B=A A=(MYX)
 IF A=B GOTO T2ES
 IF A>=B GOTO T2E0
 A=(ARSD+1)
 IF A=1 THEN L- GOTO T1E1L
 GOTO RMOVE
T2E0  A=(ARSD+2)
 IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOVE
T2ES  A=(+DE-)
 B=A A=(MYY)
 IF A>=B GOTO T2E1
 A=(ARSD)
 IF A=1 THEN H- GOTO T1E1U
 GOTO RMOVE
T2E1  A=(ARSD+3)
 IF A=1 THEN H+ GOTO T1E1D
 GOTO RMOVE
;
GGC   [AF [HL [BC [DE
 !VOP
 A=0 HL=$E500
 (HL)=A
 DE=$E501 BC=$1A40
 LDIR
 !VCL
 ]DE ]BC ]HL ]AF
 RET
;
 !("K.Kuromusha Original No.7")
;
END
